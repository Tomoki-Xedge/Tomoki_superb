<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Interaction</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .form-container { margin-bottom: 20px; }
        .form-container input { margin-bottom: 10px; }
        .result { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>API Interaction</h1>
    
    <!-- Select Form -->
    <div class="form-container">
        <h2>IDとパスワードの確認</h2>
        <input type="text" id="selectId" placeholder="ID" />
        <input type="password" id="selectPassword" placeholder="Password" />
        <button onclick="selectUser()">確認</button>
        <div id="selectResult" class="result"></div>
    </div>
    
    <!-- Insert Form -->
    <div class="form-container">
        <h2>会員登録</h2>
        <input type="text" id="insertNickname" placeholder="Nickname" />
        <input type="text" id="insertId" placeholder="ID" />
        <input type="password" id="insertPassword" placeholder="Password" />
        <button onclick="insertUser()">登録</button>
        <div id="insertResult" class="result"></div>
    </div>
    
    <!-- Fortune Result Form -->
    <div class="form-container">
        <h2>おみくじ結果</h2>
        <button onclick="getFortuneResult()">結果を取得</button>
        <div id="fortuneResult" class="result"></div>
    </div>

    <script>
        const apiBaseUrl = 'https://your-function-app-url.azurewebsites.net/api/';

        async function selectUser() {
            const id = document.getElementById('selectId').value;
            const password = document.getElementById('selectPassword').value;
            const resultDiv = document.getElementById('selectResult');

            if (!id || !password) {
                resultDiv.textContent = 'ID と Password を入力してください。';
                return;
            }

            try {
                const response = await fetch(`${apiBaseUrl}SELECT?ID=${encodeURIComponent(id)}&Password=${encodeURIComponent(password)}`, {
                    method: 'GET',
                });

                const result = await response.json();
                if (response.ok) {
                    resultDiv.textContent = 'ログイン成功！';
                } else {
                    resultDiv.textContent = result.Message || 'ログイン失敗';
                }
            } catch (error) {
                resultDiv.textContent = 'エラーが発生しました。';
            }
        }

        async function insertUser() {
            const nickname = document.getElementById('insertNickname').value;
            const id = document.getElementById('insertId').value;
            const password = document.getElementById('insertPassword').value;
            const resultDiv = document.getElementById('insertResult');

            if (!nickname || !id || !password) {
                resultDiv.textContent = '全てのフィールドを入力してください。';
                return;
            }

            try {
                const response = await fetch(`${apiBaseUrl}INSERT`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ Nickname: nickname, ID: id, Password: password }),
                });

                const result = await response.json();
                if (response.ok) {
                    resultDiv.textContent = '登録成功！';
                } else {
                    resultDiv.textContent = result.Message || '登録失敗';
                }
            } catch (error) {
                resultDiv.textContent = 'エラーが発生しました。';
            }
        }

        async function getFortuneResult() {
            const resultDiv = document.getElementById('fortuneResult');

            try {
                const response = await fetch(`${apiBaseUrl}GET_FORTUNE_RESULT`, {
                    method: 'GET',
                });

                const result = await response.json();
                if (response.ok) {
                    resultDiv.textContent = `おみくじ結果: ${result.Result}`;
                } else {
                    resultDiv.textContent = '結果取得に失敗しました';
                }
            } catch (error) {
                resultDiv.textContent = 'エラーが発生しました。';
            }
        }
    </script>
</body>
</html>
